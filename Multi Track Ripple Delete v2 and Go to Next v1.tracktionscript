<?xml version="1.0" encoding="UTF-8"?>

<MACRO name="Multi Track Ripple Delete v2 and Go to Next v1" script="/**&#13;&#10;    Name:Multi Track Ripple Delete and Go to Next&#13;&#10;    Description:The selected clip or clips in the single track become the extent of the&#13;&#10;        ripple delete. The first and the last slip tell how much is deleted and shifted.&#13;&#10;    Author:Andrew Cheung&#13;&#10;    Version:V1&#13;&#10;    Changelog:&#13;&#10;    +includes helper functions like get next clip&#13;&#10;**/&#13;&#10;var curPos = Tracktion.getPosition ('cursor');&#13;&#10;var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;copyOneClip (curClips);&#13;&#10;var allTracks = getAllTracks();&#13;&#10;var rightClip = getRightClip();&#13;&#10;//Tracktion.markAroundSelected();//get current selected&#13;&#10;&#13;&#10;//chop out selection&#13;&#10;Tracktion.markAroundSelected();//get current selected&#13;&#10;//get a clip with in the selected region&#13;&#10;var selMarkInPos = Tracktion.getPosition ('markIn');&#13;&#10;var selMarkOutPos = Tracktion.getPosition ('markOut');&#13;&#10;//check if all tracks have clips in the span&#13;&#10;//which if not will paste something there temporarily&#13;&#10;&#13;&#10;&#13;&#10;//select all clips&#13;&#10;Tracktion.addObjectsToSelection (Tracktion.getEditElements ('clip'));&#13;&#10;&#13;&#10;    //split at clip some stuff&#13;&#10;    Tracktion.jumpToMarkIn();&#13;&#10;    Tracktion.splitClips();&#13;&#10;    Tracktion.jumpToMarkOut();&#13;&#10;    Tracktion.splitClips();&#13;&#10;&#13;&#10;    for (i = 0; i &lt; allTracks.length; i++){//goes through all tracks to make sure ripple delete does it to all&#13;&#10;        Tracktion.selectItem ('none');&#13;&#10;        Tracktion.addObjectsToSelection (allTracks[i]);&#13;&#10;        Tracktion.jumpToMarkIn();&#13;&#10;        Tracktion.paste();//adds a dummy clip to every track to allow ripple delete to work&#13;&#10;    }&#13;&#10;&#13;&#10;    Tracktion.addObjectsToSelection (Tracktion.getEditElements ('clip'));&#13;&#10;&#13;&#10;    Tracktion.deleteMarkedRegionOfSelectedClipsAndClose();&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (rightClip);&#13;&#10;&#13;&#10;&#13;&#10;//    Tracktion.addObjectsToSelection (allTracks[4]);&#13;&#10;//end&#13;&#10;&#13;&#10;Tracktion.setPosition ('cursor', curPos);&#13;&#10;Tracktion.setPosition ('markIn', markInPos);&#13;&#10;Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;&#13;&#10;//Functions&#13;&#10;function copyOneClip (clips) {&#13;&#10;    /**&#13;&#10;        Name:Copy One Selected&#13;&#10;        Description:Given clips, Copy one of them&#13;&#10;        Author:Andrew&#13;&#10;        Version:V1&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //insert code here&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (clips[0]);&#13;&#10;    Tracktion.copy();&#13;&#10;    //code end&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;&#13;&#10;}&#13;&#10;&#13;&#10;function getAllTracks(){&#13;&#10;    /**&#13;&#10;        Name:Get All Tracks&#13;&#10;        Description:gets an array of tracks from the edit&#13;&#10;        Author:Andrew&#13;&#10;        Version:V1&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //insert code here&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (Tracktion.getEditElements ('track'));&#13;&#10;    var allTracks;&#13;&#10;    allTracks = Tracktion.getSelectedEditElements ('track');    &#13;&#10;    //code end&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;    return allTracks;&#13;&#10;}&#13;&#10;&#13;&#10;function getRightClip (){&#13;&#10;    /**&#13;&#10;        Name:Get Clip to the Right&#13;&#10;        Description:Gives you what everclip is to the right of the selection&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V1&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    var rightClip;&#13;&#10;    //insert code here&#13;&#10;    Tracktion.selectItem ('right');&#13;&#10;    rightClip = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //code end&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;    return rightClip;&#13;&#10;}&#13;&#10;&#13;&#10;function selMarkedRegion() {&#13;&#10;     /**&#13;&#10;        Name:Marked Region Clip Select&#13;&#10;        Description:Selects a clip that starts in the marked region. If you have selected all the clips in the track&#13;&#10;            The selected track will be from the first track because of Tracktion logic.&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V4&#13;&#10;        Changelog:&#13;&#10;        +fixed bug where selectItem jumps to another track when there is only 1 clip in the track.&#13;&#10;        +changed workaround to proper logic using getClipsFromTracks instead of getSelectedEditElements.&#13;&#10;        +fixed can't deal with the last clip&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.//selects all clips in between the in/out markers&#13;&#10;    //affects the in/out markers&#13;&#10;    //&#13;&#10;    ////saves state for markers and cursors&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;&#13;&#10;    //insert code here&#13;&#10;    //Tracktion.selectItem ('none');//do not select all after selecting none as that will lead to a loss of focus&#13;&#10;    var markedClips;// = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    var trackObject = Tracktion.getTrackFromSelectedObject();&#13;&#10;    var trackClips = Tracktion.getClipsFromTracks (trackObject);&#13;&#10;    var trackClipCount = trackClips.length;&#13;&#10;    var firstClip;&#13;&#10;    var lastClip;&#13;&#10;&#13;&#10;    var clipMarkInPos;&#13;&#10;    var clipMarkOutPos; &#13;&#10;    var temp;&#13;&#10;&#13;&#10;    for (i = 0; i &lt; trackClipCount; i++) {// for each clip&#13;&#10;        Tracktion.selectItem ('none');&#13;&#10;        Tracktion.addObjectsToSelection (trackClips[i]);//grab positions to check if it is in marked area&#13;&#10;    //    temp = Tracktion.getSelectedEditElements ('clip');//holds the current indexed object&#13;&#10;        Tracktion.markAroundSelected();&#13;&#10;        clipMarkInPos = Tracktion.getPosition ('markIn');&#13;&#10;        clipMarkOutPos = Tracktion.getPosition ('markOut');&#13;&#10;        if (markInPos &lt;= clipMarkInPos &amp;&amp; clipMarkInPos &lt; markOutPos){//&#13;&#10;            Tracktion.addObjectsToSelection (markedClips);&#13;&#10;            markedClips = Tracktion.getSelectedEditElements ('clip');//puts the clip into the marked clip list&#13;&#10;            //break;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (markedClips);&#13;&#10;    //code end&#13;&#10;&#13;&#10;    //reset changes to markers and cursors&#13;&#10;    //Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;}&#13;&#10;"/>
