<?xml version="1.0" encoding="UTF-8"?>

<MACRO name="Select Clips In Marked Region [From Current Track from Clip's Selected] v4"
       script="/**&#13;&#10;    Name:Marked Region Clip Select&#13;&#10;    Description:Selects a clip that starts in the marked region. If you have selected all the clips in the track&#13;&#10;        The selected track will be from the first track because of Tracktion logic.&#13;&#10;    Author:Andrew Cheung&#13;&#10;    Version:V4&#13;&#10;    Changelog:&#13;&#10;    +fixed bug where selectItem jumps to another track when there is only 1 clip in the track.&#13;&#10;    +changed workaround to proper logic using getClipsFromTracks instead of getSelectedEditElements.&#13;&#10;    +fixed can't deal with the last clip&#13;&#10;    -only works with one track at a time&#13;&#10;**/&#13;&#10;//Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.//selects all clips in between the in/out markers&#13;&#10;//affects the in/out markers&#13;&#10;//&#13;&#10;////saves state for markers and cursors&#13;&#10;var curPos = Tracktion.getPosition ('cursor');&#13;&#10;var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;&#13;&#10;//insert code here&#13;&#10;//Tracktion.selectItem ('none');//do not select all after selecting none as that will lead to a loss of focus&#13;&#10;var markedClips;// = Tracktion.getSelectedEditElements ('clip');&#13;&#10;var trackObject = Tracktion.getTrackFromSelectedObject();&#13;&#10;var trackClips = Tracktion.getClipsFromTracks (trackObject);&#13;&#10;var trackClipCount = trackClips.length;&#13;&#10;var firstClip;&#13;&#10;var lastClip;&#13;&#10;&#13;&#10;var clipMarkInPos;&#13;&#10;var clipMarkOutPos; &#13;&#10;var temp;&#13;&#10;&#13;&#10;for (i = 0; i &lt; trackClipCount; i++) {// for each clip&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (trackClips[i]);//grab positions to check if it is in marked area&#13;&#10;//    temp = Tracktion.getSelectedEditElements ('clip');//holds the current indexed object&#13;&#10;    Tracktion.markAroundSelected();&#13;&#10;    clipMarkInPos = Tracktion.getPosition ('markIn');&#13;&#10;    clipMarkOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    if (markInPos &lt;= clipMarkInPos &amp;&amp; clipMarkInPos &lt; markOutPos){//&#13;&#10;        Tracktion.addObjectsToSelection (markedClips);&#13;&#10;        markedClips = Tracktion.getSelectedEditElements ('clip');//puts the clip into the marked clip list&#13;&#10;        //break;&#13;&#10;    }&#13;&#10;}&#13;&#10;&#13;&#10;Tracktion.selectItem ('none');&#13;&#10;Tracktion.addObjectsToSelection (markedClips);&#13;&#10;//code end&#13;&#10;&#13;&#10;//reset changes to markers and cursors&#13;&#10;//Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;Tracktion.setPosition ('cursor', curPos);&#13;&#10;Tracktion.setPosition ('markIn', markInPos);&#13;&#10;Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;&#13;&#10;"/>
