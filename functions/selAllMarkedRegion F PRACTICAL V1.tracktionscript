<?xml version="1.0" encoding="UTF-8"?>

<MACRO name="selAllMarkedRegion F PRACTICAL V1" script="selAllMarkedRegion();&#13;&#10;function selAllMarkedRegion() {&#13;&#10;     /**&#13;&#10;        Name:All Marked Region Clip Select [Prectically Should Work]&#13;&#10;        Description:Selects all clips from the edit in the marked region, it must start in the marked region, &#13;&#10;            endings don't count.&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V1&#13;&#10;        Changelog:&#13;&#10;        -there is a for loop bug that won't allow the code to be handled...&#13;&#10;        -it should theoretically work but it doesn't&#13;&#10;&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.//selects all clips in between the in/out markers&#13;&#10;    //affects the in/out markers&#13;&#10;    //&#13;&#10;    ////saves state for markers and cursors&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;&#13;&#10;    //insert code here&#13;&#10;    //Tracktion.selectItem ('none');//do not select all after selecting none as that will lead to a loss of focus&#13;&#10;    var allTracks = getAllTracks();&#13;&#10;    var curTrackClips;&#13;&#10;    var markedClips;&#13;&#10;    var markedClipsCollection;&#13;&#10;    var trackCount = allTracks.length;&#13;&#10;&#13;&#10;//    for (i = 0; i &lt; trackCount; i++){&#13;&#10;//loop one would go&#13;&#10;        curTrackClips = Tracktion.getClipsFromTracks (allTracks[0]);&#13;&#10;        Tracktion.selectItem ('none');&#13;&#10;        Tracktion.addObjectsToSelection (curTrackClips[0]);//gets selMarkedRegion a cliptrack&#13;&#10;        selMarkedRegion();//may mark nothing&#13;&#10;        markedClipsCollection = addSelClips (markedClipsCollection);&#13;&#10;//loop two would go &#13;&#10;        curTrackClips = Tracktion.getClipsFromTracks (allTracks[1]);&#13;&#10;        Tracktion.selectItem ('none');&#13;&#10;        Tracktion.addObjectsToSelection (curTrackClips[0]);//gets selMarkedRegion a cliptrack&#13;&#10;        selMarkedRegion();//may mark nothing&#13;&#10;        markedClipsCollection = addSelClips (markedClipsCollection);&#13;&#10;//    }&#13;&#10;&#13;&#10;    //code end&#13;&#10;&#13;&#10;    //reset changes to markers and cursors&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (markedClipsCollection);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;}&#13;&#10;//functions&#13;&#10;function addSelClips (clipArray){&#13;&#10;    /**&#13;&#10;        Name:Add Selected Clips&#13;&#10;        Description:Adds the clipArray's clips and the selected clip together&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V1&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //insert code here  &#13;&#10;    Tracktion.addObjectsToSelection (clipArray);&#13;&#10;    clipArray = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //code end&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;    return clipArray;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;function getAllTracks (){&#13;&#10;    /**&#13;&#10;        Name:Get All Tracks&#13;&#10;        Description:gets an array of tracks from the edit&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V1&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    //insert code here&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (Tracktion.getEditElements ('track'));&#13;&#10;    var allTracks;&#13;&#10;    allTracks = Tracktion.getSelectedEditElements ('track');    &#13;&#10;    //code end&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;    return allTracks;&#13;&#10;}&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;function selMarkedRegion() {&#13;&#10;     /**&#13;&#10;        Name:Marked Region Clip Select&#13;&#10;        Description:Selects a clip that starts in the marked region. If you have selected all the clips in the track&#13;&#10;            The selected track will be from the first track because of Tracktion logic.&#13;&#10;        Author:Andrew Cheung&#13;&#10;        Version:V4&#13;&#10;        Changelog:&#13;&#10;        +fixed bug where selectItem jumps to another track when there is only 1 clip in the track.&#13;&#10;        +changed workaround to proper logic using getClipsFromTracks instead of getSelectedEditElements.&#13;&#10;        +fixed can't deal with the last clip&#13;&#10;    **/&#13;&#10;    //Tip: Don't Select None Without keeping a focusable object or there will be a freeze state.//selects all clips in between the in/out markers&#13;&#10;    //affects the in/out markers&#13;&#10;    //&#13;&#10;    ////saves state for markers and cursors&#13;&#10;    var curPos = Tracktion.getPosition ('cursor');&#13;&#10;    var markInPos = Tracktion.getPosition ('markIn');&#13;&#10;    var markOutPos = Tracktion.getPosition ('markOut');&#13;&#10;    var curClips = Tracktion.getSelectedEditElements ('clip');&#13;&#10;&#13;&#10;    //insert code here&#13;&#10;    //Tracktion.selectItem ('none');//do not select all after selecting none as that will lead to a loss of focus&#13;&#10;    var markedClips;// = Tracktion.getSelectedEditElements ('clip');&#13;&#10;    var trackObject = Tracktion.getTrackFromSelectedObject();&#13;&#10;    var trackClips = Tracktion.getClipsFromTracks (trackObject);&#13;&#10;    var trackClipCount = trackClips.length;&#13;&#10;    var firstClip;&#13;&#10;    var lastClip;&#13;&#10;&#13;&#10;    var clipMarkInPos;&#13;&#10;    var clipMarkOutPos; &#13;&#10;    var temp;&#13;&#10;    var i;&#13;&#10;    for (i = 0; i &lt; trackClipCount; i++) {// for each clip&#13;&#10;        Tracktion.selectItem ('none');&#13;&#10;        Tracktion.addObjectsToSelection (trackClips[i]);//grab positions to check if it is in marked area&#13;&#10;    //    temp = Tracktion.getSelectedEditElements ('clip');//holds the current indexed object&#13;&#10;        Tracktion.markAroundSelected();&#13;&#10;        clipMarkInPos = Tracktion.getPosition ('markIn');&#13;&#10;        clipMarkOutPos = Tracktion.getPosition ('markOut');&#13;&#10;        if (markInPos &lt;= clipMarkInPos &amp;&amp; clipMarkInPos &lt; markOutPos){//&#13;&#10;            Tracktion.addObjectsToSelection (markedClips);&#13;&#10;            markedClips = Tracktion.getSelectedEditElements ('clip');//puts the clip into the marked clip list&#13;&#10;            //break;&#13;&#10;        }&#13;&#10;    }&#13;&#10;&#13;&#10;    Tracktion.selectItem ('none');&#13;&#10;    Tracktion.addObjectsToSelection (markedClips);&#13;&#10;    //code end&#13;&#10;&#13;&#10;    //reset changes to markers and cursors&#13;&#10;    //Tracktion.addObjectsToSelection (curClips);//if you select some stuff and haven't deleted any clips use this to default&#13;&#10;    Tracktion.setPosition ('cursor', curPos);&#13;&#10;    Tracktion.setPosition ('markIn', markInPos);&#13;&#10;    Tracktion.setPosition ('markOut', markOutPos);&#13;&#10;}&#13;&#10;"/>
